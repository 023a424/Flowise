{
    "description": "Example of branching out into different agents, and merge the final responses back into one",
    "nodes": [
        {
            "id": "chatOpenAI_0",
            "position": {
                "x": -322.94438002164657,
                "y": 73
            },
            "type": "customNode",
            "data": {
                "id": "chatOpenAI_0",
                "label": "ChatOpenAI",
                "version": 6,
                "name": "chatOpenAI",
                "type": "ChatOpenAI",
                "baseClasses": ["ChatOpenAI", "BaseChatModel", "BaseLanguageModel", "Runnable"],
                "category": "Chat Models",
                "description": "Wrapper around OpenAI large language models that use the Chat endpoint",
                "inputParams": [
                    {
                        "label": "Connect Credential",
                        "name": "credential",
                        "type": "credential",
                        "credentialNames": ["openAIApi"],
                        "id": "chatOpenAI_0-input-credential-credential"
                    },
                    {
                        "label": "Model Name",
                        "name": "modelName",
                        "type": "asyncOptions",
                        "loadMethod": "listModels",
                        "default": "gpt-3.5-turbo",
                        "id": "chatOpenAI_0-input-modelName-asyncOptions"
                    },
                    {
                        "label": "Temperature",
                        "name": "temperature",
                        "type": "number",
                        "step": 0.1,
                        "default": 0.9,
                        "optional": true,
                        "id": "chatOpenAI_0-input-temperature-number"
                    },
                    {
                        "label": "Max Tokens",
                        "name": "maxTokens",
                        "type": "number",
                        "step": 1,
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-maxTokens-number"
                    },
                    {
                        "label": "Top Probability",
                        "name": "topP",
                        "type": "number",
                        "step": 0.1,
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-topP-number"
                    },
                    {
                        "label": "Frequency Penalty",
                        "name": "frequencyPenalty",
                        "type": "number",
                        "step": 0.1,
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-frequencyPenalty-number"
                    },
                    {
                        "label": "Presence Penalty",
                        "name": "presencePenalty",
                        "type": "number",
                        "step": 0.1,
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-presencePenalty-number"
                    },
                    {
                        "label": "Timeout",
                        "name": "timeout",
                        "type": "number",
                        "step": 1,
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-timeout-number"
                    },
                    {
                        "label": "BasePath",
                        "name": "basepath",
                        "type": "string",
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-basepath-string"
                    },
                    {
                        "label": "BaseOptions",
                        "name": "baseOptions",
                        "type": "json",
                        "optional": true,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-baseOptions-json"
                    },
                    {
                        "label": "Allow Image Uploads",
                        "name": "allowImageUploads",
                        "type": "boolean",
                        "description": "Automatically uses gpt-4-vision-preview when image is being uploaded from chat. Only works with LLMChain, Conversation Chain, ReAct Agent, and Conversational Agent",
                        "default": false,
                        "optional": true,
                        "id": "chatOpenAI_0-input-allowImageUploads-boolean"
                    },
                    {
                        "label": "Image Resolution",
                        "description": "This parameter controls the resolution in which the model views the image.",
                        "name": "imageResolution",
                        "type": "options",
                        "options": [
                            {
                                "label": "Low",
                                "name": "low"
                            },
                            {
                                "label": "High",
                                "name": "high"
                            },
                            {
                                "label": "Auto",
                                "name": "auto"
                            }
                        ],
                        "default": "low",
                        "optional": false,
                        "additionalParams": true,
                        "id": "chatOpenAI_0-input-imageResolution-options"
                    }
                ],
                "inputAnchors": [
                    {
                        "label": "Cache",
                        "name": "cache",
                        "type": "BaseCache",
                        "optional": true,
                        "id": "chatOpenAI_0-input-cache-BaseCache"
                    }
                ],
                "inputs": {
                    "cache": "",
                    "modelName": "gpt-3.5-turbo",
                    "temperature": 0.9,
                    "maxTokens": "",
                    "topP": "",
                    "frequencyPenalty": "",
                    "presencePenalty": "",
                    "timeout": "",
                    "basepath": "",
                    "baseOptions": "",
                    "allowImageUploads": "",
                    "imageResolution": "low"
                },
                "outputAnchors": [
                    {
                        "id": "chatOpenAI_0-output-chatOpenAI-ChatOpenAI|BaseChatModel|BaseLanguageModel|Runnable",
                        "name": "chatOpenAI",
                        "label": "ChatOpenAI",
                        "description": "Wrapper around OpenAI large language models that use the Chat endpoint",
                        "type": "ChatOpenAI | BaseChatModel | BaseLanguageModel | Runnable"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 669,
            "selected": false,
            "positionAbsolute": {
                "x": -322.94438002164657,
                "y": 73
            },
            "dragging": false
        },
        {
            "id": "seqAgent_0",
            "position": {
                "x": 475.17412697756333,
                "y": 64.39433713180921
            },
            "type": "customNode",
            "data": {
                "id": "seqAgent_0",
                "label": "Agent",
                "version": 1,
                "name": "seqAgent",
                "type": "Agent",
                "baseClasses": ["Agent"],
                "category": "Sequential Agents",
                "inputParams": [
                    {
                        "label": "Agent Name",
                        "name": "agentName",
                        "type": "string",
                        "placeholder": "Agent",
                        "id": "seqAgent_0-input-agentName-string"
                    },
                    {
                        "label": "System Prompt",
                        "name": "agentPrompt",
                        "type": "string",
                        "rows": 4,
                        "default": "You are a research assistant who can search for up-to-date info using search engine.",
                        "id": "seqAgent_0-input-agentPrompt-string"
                    },
                    {
                        "label": "Format Prompt Values",
                        "name": "promptValues",
                        "description": "Assign values to the prompt variables. You can also use $flow.state.<variable-name> to get the state value",
                        "type": "json",
                        "optional": true,
                        "acceptVariable": true,
                        "list": true,
                        "id": "seqAgent_0-input-promptValues-json"
                    },
                    {
                        "label": "Update State",
                        "name": "updateStateMemory",
                        "type": "datagrid",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Fill in the key and value pair to be updated. Key must exists in the State schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values",
                        "datagrid": [
                            {
                                "field": "key",
                                "headerName": "Key",
                                "editable": true
                            },
                            {
                                "field": "value",
                                "headerName": "Value",
                                "editable": true,
                                "flex": 1
                            }
                        ],
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_0-input-updateStateMemory-datagrid"
                    },
                    {
                        "label": "Update State (Code)",
                        "name": "updateStateMemoryCode",
                        "type": "code",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Must return an object. Object must contains at least one key that matches State's schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values. This will be used when both \"Update State\" and \"Update State (Code)\" are provided. Must return an object representing the state",
                        "hideCodeExecute": true,
                        "codeExample": "const result = $flow.output;\n\n/* Suppose we have a custom State schema like this:\n* {\n    aggregate: {\n        value: (x, y) => x.concat(y),\n        default: () => []\n    }\n  }\n*/\n\nreturn {\n  aggregate: [result.output] //update state by returning an object with the same schema\n};",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_0-input-updateStateMemoryCode-code"
                    },
                    {
                        "label": "Max Iterations",
                        "name": "maxIterations",
                        "type": "number",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_0-input-maxIterations-number"
                    }
                ],
                "inputAnchors": [
                    {
                        "label": "Tools",
                        "name": "tools",
                        "type": "Tool",
                        "list": true,
                        "optional": true,
                        "id": "seqAgent_0-input-tools-Tool"
                    },
                    {
                        "label": "Agent/Start",
                        "name": "agentOrStart",
                        "type": "Agent | START",
                        "list": true,
                        "id": "seqAgent_0-input-agentOrStart-Agent | START"
                    },
                    {
                        "label": "Chat Model",
                        "name": "model",
                        "type": "BaseChatModel",
                        "optional": true,
                        "description": "Overwrite model to be used for this agent",
                        "id": "seqAgent_0-input-model-BaseChatModel"
                    }
                ],
                "inputs": {
                    "agentName": "AgentA",
                    "agentPrompt": "You can only reply \"I am A\"",
                    "tools": "",
                    "agentOrStart": ["{{seqStart_0.data.instance}}"],
                    "model": "",
                    "promptValues": "",
                    "updateStateMemory": "",
                    "updateStateMemoryCode": "",
                    "maxIterations": ""
                },
                "outputAnchors": [
                    {
                        "id": "seqAgent_0-output-seqAgent-Agent",
                        "name": "seqAgent",
                        "label": "Agent",
                        "description": "",
                        "type": "Agent"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 762,
            "selected": false,
            "positionAbsolute": {
                "x": 475.17412697756333,
                "y": 64.39433713180921
            },
            "dragging": false
        },
        {
            "id": "seqStart_0",
            "position": {
                "x": 81.08459247904065,
                "y": 251.15006727347367
            },
            "type": "customNode",
            "data": {
                "id": "seqStart_0",
                "label": "Start",
                "version": 1,
                "name": "seqStart",
                "type": "START",
                "baseClasses": ["START"],
                "category": "Sequential Agents",
                "description": "Starting point of the conversation",
                "inputParams": [],
                "inputAnchors": [
                    {
                        "label": "Chat Model",
                        "name": "model",
                        "type": "BaseChatModel",
                        "description": "Only compatible with models that are capable of function calling: ChatOpenAI, ChatMistral, ChatAnthropic, ChatGoogleGenerativeAI, ChatVertexAI, GroqChat",
                        "id": "seqStart_0-input-model-BaseChatModel"
                    },
                    {
                        "label": "Agent Memory",
                        "name": "agentMemory",
                        "type": "BaseCheckpointSaver",
                        "description": "Save the state of the agent",
                        "optional": true,
                        "id": "seqStart_0-input-agentMemory-BaseCheckpointSaver"
                    },
                    {
                        "label": "State",
                        "name": "state",
                        "type": "State",
                        "description": "State is an object that is updated by nodes in the graph, passing from one node to another. Agent Memory must be connected when using State. By default, state contains \"messages\" that got updated with each message sent and received.",
                        "optional": true,
                        "id": "seqStart_0-input-state-State"
                    },
                    {
                        "label": "Input Moderation",
                        "description": "Detect text that could generate harmful output and prevent it from being sent to the language model",
                        "name": "inputModeration",
                        "type": "Moderation",
                        "optional": true,
                        "list": true,
                        "id": "seqStart_0-input-inputModeration-Moderation"
                    }
                ],
                "inputs": {
                    "model": "{{chatOpenAI_0.data.instance}}",
                    "agentMemory": "",
                    "state": "",
                    "inputModeration": ""
                },
                "outputAnchors": [
                    {
                        "id": "seqStart_0-output-seqStart-START",
                        "name": "seqStart",
                        "label": "START",
                        "description": "Starting point of the conversation",
                        "type": "START"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 382,
            "selected": false,
            "positionAbsolute": {
                "x": 81.08459247904065,
                "y": 251.15006727347367
            },
            "dragging": false
        },
        {
            "id": "seqEnd_0",
            "position": {
                "x": 1659.384058229281,
                "y": 453.04815391311087
            },
            "type": "customNode",
            "data": {
                "id": "seqEnd_0",
                "label": "End",
                "version": 1,
                "name": "seqEnd",
                "type": "END",
                "baseClasses": ["END"],
                "category": "Sequential Agents",
                "description": "End conversation",
                "inputParams": [],
                "inputAnchors": [
                    {
                        "label": "Agent/End",
                        "name": "agentOrEnd",
                        "type": "Agent | END",
                        "id": "seqEnd_0-input-agentOrEnd-Agent | END"
                    }
                ],
                "inputs": {
                    "agentOrEnd": "{{seqAgent_3.data.instance}}"
                },
                "outputAnchors": [],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 143,
            "positionAbsolute": {
                "x": 1659.384058229281,
                "y": 453.04815391311087
            },
            "selected": false,
            "dragging": false
        },
        {
            "id": "seqAgent_1",
            "position": {
                "x": 882.9394380021648,
                "y": -300.5752810244579
            },
            "type": "customNode",
            "data": {
                "id": "seqAgent_1",
                "label": "Agent",
                "version": 1,
                "name": "seqAgent",
                "type": "Agent",
                "baseClasses": ["Agent"],
                "category": "Sequential Agents",
                "inputParams": [
                    {
                        "label": "Agent Name",
                        "name": "agentName",
                        "type": "string",
                        "placeholder": "Agent",
                        "id": "seqAgent_1-input-agentName-string"
                    },
                    {
                        "label": "System Prompt",
                        "name": "agentPrompt",
                        "type": "string",
                        "rows": 4,
                        "default": "You are a research assistant who can search for up-to-date info using search engine.",
                        "id": "seqAgent_1-input-agentPrompt-string"
                    },
                    {
                        "label": "Format Prompt Values",
                        "name": "promptValues",
                        "description": "Assign values to the prompt variables. You can also use $flow.state.<variable-name> to get the state value",
                        "type": "json",
                        "optional": true,
                        "acceptVariable": true,
                        "list": true,
                        "id": "seqAgent_1-input-promptValues-json"
                    },
                    {
                        "label": "Update State",
                        "name": "updateStateMemory",
                        "type": "datagrid",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Fill in the key and value pair to be updated. Key must exists in the State schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values",
                        "datagrid": [
                            {
                                "field": "key",
                                "headerName": "Key",
                                "editable": true
                            },
                            {
                                "field": "value",
                                "headerName": "Value",
                                "editable": true,
                                "flex": 1
                            }
                        ],
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_1-input-updateStateMemory-datagrid"
                    },
                    {
                        "label": "Update State (Code)",
                        "name": "updateStateMemoryCode",
                        "type": "code",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Must return an object. Object must contains at least one key that matches State's schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values. This will be used when both \"Update State\" and \"Update State (Code)\" are provided. Must return an object representing the state",
                        "hideCodeExecute": true,
                        "codeExample": "const result = $flow.output;\n\n/* Suppose we have a custom State schema like this:\n* {\n    aggregate: {\n        value: (x, y) => x.concat(y),\n        default: () => []\n    }\n  }\n*/\n\nreturn {\n  aggregate: [result.output] //update state by returning an object with the same schema\n};",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_1-input-updateStateMemoryCode-code"
                    },
                    {
                        "label": "Max Iterations",
                        "name": "maxIterations",
                        "type": "number",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_1-input-maxIterations-number"
                    }
                ],
                "inputAnchors": [
                    {
                        "label": "Tools",
                        "name": "tools",
                        "type": "Tool",
                        "list": true,
                        "optional": true,
                        "id": "seqAgent_1-input-tools-Tool"
                    },
                    {
                        "label": "Agent/Start",
                        "name": "agentOrStart",
                        "type": "Agent | START",
                        "list": true,
                        "id": "seqAgent_1-input-agentOrStart-Agent | START"
                    },
                    {
                        "label": "Chat Model",
                        "name": "model",
                        "type": "BaseChatModel",
                        "optional": true,
                        "description": "Overwrite model to be used for this agent",
                        "id": "seqAgent_1-input-model-BaseChatModel"
                    }
                ],
                "inputs": {
                    "agentName": "AgentB",
                    "agentPrompt": "You can only reply \"I am B\"",
                    "tools": "",
                    "agentOrStart": ["{{seqAgent_0.data.instance}}"],
                    "model": "",
                    "promptValues": "",
                    "updateStateMemory": "",
                    "updateStateMemoryCode": "",
                    "maxIterations": ""
                },
                "outputAnchors": [
                    {
                        "id": "seqAgent_1-output-seqAgent-Agent",
                        "name": "seqAgent",
                        "label": "Agent",
                        "description": "",
                        "type": "Agent"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 762,
            "selected": false,
            "positionAbsolute": {
                "x": 882.9394380021648,
                "y": -300.5752810244579
            },
            "dragging": false
        },
        {
            "id": "seqAgent_2",
            "position": {
                "x": 883.0259202351914,
                "y": 505.0757377779404
            },
            "type": "customNode",
            "data": {
                "id": "seqAgent_2",
                "label": "Agent",
                "version": 1,
                "name": "seqAgent",
                "type": "Agent",
                "baseClasses": ["Agent"],
                "category": "Sequential Agents",
                "inputParams": [
                    {
                        "label": "Agent Name",
                        "name": "agentName",
                        "type": "string",
                        "placeholder": "Agent",
                        "id": "seqAgent_2-input-agentName-string"
                    },
                    {
                        "label": "System Prompt",
                        "name": "agentPrompt",
                        "type": "string",
                        "rows": 4,
                        "default": "You are a research assistant who can search for up-to-date info using search engine.",
                        "id": "seqAgent_2-input-agentPrompt-string"
                    },
                    {
                        "label": "Format Prompt Values",
                        "name": "promptValues",
                        "description": "Assign values to the prompt variables. You can also use $flow.state.<variable-name> to get the state value",
                        "type": "json",
                        "optional": true,
                        "acceptVariable": true,
                        "list": true,
                        "id": "seqAgent_2-input-promptValues-json"
                    },
                    {
                        "label": "Update State",
                        "name": "updateStateMemory",
                        "type": "datagrid",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Fill in the key and value pair to be updated. Key must exists in the State schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values",
                        "datagrid": [
                            {
                                "field": "key",
                                "headerName": "Key",
                                "editable": true
                            },
                            {
                                "field": "value",
                                "headerName": "Value",
                                "editable": true,
                                "flex": 1
                            }
                        ],
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_2-input-updateStateMemory-datagrid"
                    },
                    {
                        "label": "Update State (Code)",
                        "name": "updateStateMemoryCode",
                        "type": "code",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Must return an object. Object must contains at least one key that matches State's schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values. This will be used when both \"Update State\" and \"Update State (Code)\" are provided. Must return an object representing the state",
                        "hideCodeExecute": true,
                        "codeExample": "const result = $flow.output;\n\n/* Suppose we have a custom State schema like this:\n* {\n    aggregate: {\n        value: (x, y) => x.concat(y),\n        default: () => []\n    }\n  }\n*/\n\nreturn {\n  aggregate: [result.output] //update state by returning an object with the same schema\n};",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_2-input-updateStateMemoryCode-code"
                    },
                    {
                        "label": "Max Iterations",
                        "name": "maxIterations",
                        "type": "number",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_2-input-maxIterations-number"
                    }
                ],
                "inputAnchors": [
                    {
                        "label": "Tools",
                        "name": "tools",
                        "type": "Tool",
                        "list": true,
                        "optional": true,
                        "id": "seqAgent_2-input-tools-Tool"
                    },
                    {
                        "label": "Agent/Start",
                        "name": "agentOrStart",
                        "type": "Agent | START",
                        "list": true,
                        "id": "seqAgent_2-input-agentOrStart-Agent | START"
                    },
                    {
                        "label": "Chat Model",
                        "name": "model",
                        "type": "BaseChatModel",
                        "optional": true,
                        "description": "Overwrite model to be used for this agent",
                        "id": "seqAgent_2-input-model-BaseChatModel"
                    }
                ],
                "inputs": {
                    "agentName": "AgentC",
                    "agentPrompt": "You can only reply \"I am C\"",
                    "tools": "",
                    "agentOrStart": ["{{seqAgent_0.data.instance}}"],
                    "model": "",
                    "promptValues": "",
                    "updateStateMemory": "",
                    "updateStateMemoryCode": "",
                    "maxIterations": ""
                },
                "outputAnchors": [
                    {
                        "id": "seqAgent_2-output-seqAgent-Agent",
                        "name": "seqAgent",
                        "label": "Agent",
                        "description": "",
                        "type": "Agent"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 762,
            "selected": false,
            "positionAbsolute": {
                "x": 883.0259202351914,
                "y": 505.0757377779404
            },
            "dragging": false
        },
        {
            "id": "seqAgent_3",
            "position": {
                "x": 1292.732559015943,
                "y": 60.51168161950852
            },
            "type": "customNode",
            "data": {
                "id": "seqAgent_3",
                "label": "Agent",
                "version": 1,
                "name": "seqAgent",
                "type": "Agent",
                "baseClasses": ["Agent"],
                "category": "Sequential Agents",
                "inputParams": [
                    {
                        "label": "Agent Name",
                        "name": "agentName",
                        "type": "string",
                        "placeholder": "Agent",
                        "id": "seqAgent_3-input-agentName-string"
                    },
                    {
                        "label": "System Prompt",
                        "name": "agentPrompt",
                        "type": "string",
                        "rows": 4,
                        "default": "You are a research assistant who can search for up-to-date info using search engine.",
                        "id": "seqAgent_3-input-agentPrompt-string"
                    },
                    {
                        "label": "Format Prompt Values",
                        "name": "promptValues",
                        "description": "Assign values to the prompt variables. You can also use $flow.state.<variable-name> to get the state value",
                        "type": "json",
                        "optional": true,
                        "acceptVariable": true,
                        "list": true,
                        "id": "seqAgent_3-input-promptValues-json"
                    },
                    {
                        "label": "Update State",
                        "name": "updateStateMemory",
                        "type": "datagrid",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Fill in the key and value pair to be updated. Key must exists in the State schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values",
                        "datagrid": [
                            {
                                "field": "key",
                                "headerName": "Key",
                                "editable": true
                            },
                            {
                                "field": "value",
                                "headerName": "Value",
                                "editable": true,
                                "flex": 1
                            }
                        ],
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_3-input-updateStateMemory-datagrid"
                    },
                    {
                        "label": "Update State (Code)",
                        "name": "updateStateMemoryCode",
                        "type": "code",
                        "hint": {
                            "label": "How to use",
                            "value": "\n1. Must return an object. Object must contains at least one key that matches State's schema\n\n2. Agent's output is available as `$flow.output` with the following structure:\n    ```json\n    {\n        \"output\": \"Hello! How can I assist you today?\",\n        \"usedTools\": [\n            {\n                \"tool\": \"tool-name\",\n                \"toolInput\": \"{foo: var}\",\n                \"toolOutput\": \"This is the tool's output\"\n            }\n        ],\n        \"sourceDocuments\": [\n            {\n                \"pageContent\": \"This is the page content\",\n                \"metadata\": \"{foo: var}\",\n            }\n        ],\n    }\n    ```\n\n3. You can get default flow config:\n    - `$flow.sessionId`\n    - `$flow.chatId`\n    - `$flow.chatflowId`\n    - `$flow.input`\n    - `$flow.state`\n\n4. You can get custom variables: `$vars.<variable-name>`\n\n"
                        },
                        "description": "This is only applicable when you have a custom State at the START node. After agent execution, you might want to update the State values. This will be used when both \"Update State\" and \"Update State (Code)\" are provided. Must return an object representing the state",
                        "hideCodeExecute": true,
                        "codeExample": "const result = $flow.output;\n\n/* Suppose we have a custom State schema like this:\n* {\n    aggregate: {\n        value: (x, y) => x.concat(y),\n        default: () => []\n    }\n  }\n*/\n\nreturn {\n  aggregate: [result.output] //update state by returning an object with the same schema\n};",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_3-input-updateStateMemoryCode-code"
                    },
                    {
                        "label": "Max Iterations",
                        "name": "maxIterations",
                        "type": "number",
                        "optional": true,
                        "additionalParams": true,
                        "id": "seqAgent_3-input-maxIterations-number"
                    }
                ],
                "inputAnchors": [
                    {
                        "label": "Tools",
                        "name": "tools",
                        "type": "Tool",
                        "list": true,
                        "optional": true,
                        "id": "seqAgent_3-input-tools-Tool"
                    },
                    {
                        "label": "Agent/Start",
                        "name": "agentOrStart",
                        "type": "Agent | START",
                        "list": true,
                        "id": "seqAgent_3-input-agentOrStart-Agent | START"
                    },
                    {
                        "label": "Chat Model",
                        "name": "model",
                        "type": "BaseChatModel",
                        "optional": true,
                        "description": "Overwrite model to be used for this agent",
                        "id": "seqAgent_3-input-model-BaseChatModel"
                    }
                ],
                "inputs": {
                    "agentName": "AgentD",
                    "agentPrompt": "You can only reply \"I am D\"",
                    "tools": "",
                    "agentOrStart": ["{{seqAgent_1.data.instance}}", "{{seqAgent_2.data.instance}}"],
                    "model": "",
                    "promptValues": "",
                    "updateStateMemory": "",
                    "updateStateMemoryCode": "",
                    "maxIterations": ""
                },
                "outputAnchors": [
                    {
                        "id": "seqAgent_3-output-seqAgent-Agent",
                        "name": "seqAgent",
                        "label": "Agent",
                        "description": "",
                        "type": "Agent"
                    }
                ],
                "outputs": {},
                "selected": false
            },
            "width": 300,
            "height": 762,
            "selected": false,
            "positionAbsolute": {
                "x": 1292.732559015943,
                "y": 60.51168161950852
            },
            "dragging": false
        }
    ],
    "edges": [
        {
            "source": "chatOpenAI_0",
            "sourceHandle": "chatOpenAI_0-output-chatOpenAI-ChatOpenAI|BaseChatModel|BaseLanguageModel|Runnable",
            "target": "seqStart_0",
            "targetHandle": "seqStart_0-input-model-BaseChatModel",
            "type": "buttonedge",
            "id": "chatOpenAI_0-chatOpenAI_0-output-chatOpenAI-ChatOpenAI|BaseChatModel|BaseLanguageModel|Runnable-seqStart_0-seqStart_0-input-model-BaseChatModel"
        },
        {
            "source": "seqStart_0",
            "sourceHandle": "seqStart_0-output-seqStart-START",
            "target": "seqAgent_0",
            "targetHandle": "seqAgent_0-input-agentOrStart-Agent | START",
            "type": "buttonedge",
            "id": "seqStart_0-seqStart_0-output-seqStart-START-seqAgent_0-seqAgent_0-input-agentOrStart-Agent | START"
        },
        {
            "source": "seqAgent_0",
            "sourceHandle": "seqAgent_0-output-seqAgent-Agent",
            "target": "seqAgent_1",
            "targetHandle": "seqAgent_1-input-agentOrStart-Agent | START",
            "type": "buttonedge",
            "id": "seqAgent_0-seqAgent_0-output-seqAgent-Agent-seqAgent_1-seqAgent_1-input-agentOrStart-Agent | START"
        },
        {
            "source": "seqAgent_0",
            "sourceHandle": "seqAgent_0-output-seqAgent-Agent",
            "target": "seqAgent_2",
            "targetHandle": "seqAgent_2-input-agentOrStart-Agent | START",
            "type": "buttonedge",
            "id": "seqAgent_0-seqAgent_0-output-seqAgent-Agent-seqAgent_2-seqAgent_2-input-agentOrStart-Agent | START"
        },
        {
            "source": "seqAgent_1",
            "sourceHandle": "seqAgent_1-output-seqAgent-Agent",
            "target": "seqAgent_3",
            "targetHandle": "seqAgent_3-input-agentOrStart-Agent | START",
            "type": "buttonedge",
            "id": "seqAgent_1-seqAgent_1-output-seqAgent-Agent-seqAgent_3-seqAgent_3-input-agentOrStart-Agent | START"
        },
        {
            "source": "seqAgent_2",
            "sourceHandle": "seqAgent_2-output-seqAgent-Agent",
            "target": "seqAgent_3",
            "targetHandle": "seqAgent_3-input-agentOrStart-Agent | START",
            "type": "buttonedge",
            "id": "seqAgent_2-seqAgent_2-output-seqAgent-Agent-seqAgent_3-seqAgent_3-input-agentOrStart-Agent | START"
        },
        {
            "source": "seqAgent_3",
            "sourceHandle": "seqAgent_3-output-seqAgent-Agent",
            "target": "seqEnd_0",
            "targetHandle": "seqEnd_0-input-agentOrEnd-Agent | END",
            "type": "buttonedge",
            "id": "seqAgent_3-seqAgent_3-output-seqAgent-Agent-seqEnd_0-seqEnd_0-input-agentOrEnd-Agent | END"
        }
    ]
}
